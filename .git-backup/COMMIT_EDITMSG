updated code through chapter 6 in the tutorial
